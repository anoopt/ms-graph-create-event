/**
 * @license
 * v1.3.7
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2019 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["pnp.graph"]=e():t["pnp.graph"]=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t,e,n,r){var o,i=arguments.length,s=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(s=(i<3?o(s):i>3?o(e,n,s):o(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s}},function(t,e,n){"use strict";function r(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){e.apply(t,n)}}function o(t,e,n){var r=new Date(t);switch(e.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.filter((function(t){return!h(t)})).map((function(t){return t.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")})).join("/").replace(/\\/g,"/")}function s(){var t=Date.now();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)}))}function u(t){return"function"==typeof t}function a(t){return null!=t}function c(t){return Array.isArray?Array.isArray(t):t&&"number"==typeof t.length&&t.constructor===Array}function p(t,e,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=function(){return!0}),!a(e))return t;var o=n?function(t,e){return!(e in t)}:function(){return!0};return Object.getOwnPropertyNames(e).filter((function(e){return o(t,e)&&r(e)})).reduce((function(t,n){return t[n]=e[n],t}),t)}function l(t){return/^https?:\/\/|^\/\//i.test(t)}function h(t){return null==t||t.length<1}function f(t){return JSON.stringify(t)}function d(t,e){return Object.hasOwnProperty.call(t,e)}n.d(e,"d",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"h",(function(){return u})),n.d(e,"k",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return p})),n.d(e,"i",(function(){return l})),n.d(e,"j",(function(){return f})),n.d(e,"f",(function(){return d}))},function(t,e,n){"use strict";(function(t){n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return u}));var r=n(0),o=n(1);function i(t,e){null!=e&&new Request("",{headers:e}).headers.forEach((function(e,n){t.append(n,e)}))}function s(t,e){if(Object(o.k)(e)){var n=Object(o.c)(t.headers||{},e.headers);(t=Object(o.c)(t,e)).headers=n}}var u=function(t){function e(e){var n=t.call(this)||this;return n._token=e,n}return r.b(e,t),Object.defineProperty(e.prototype,"token",{get:function(){return this._token||""},set:function(t){this._token=t},enumerable:!0,configurable:!0}),e.prototype.fetch=function(e,n){void 0===n&&(n={});var r=new Headers;return i(r,n.headers),r.set("Authorization","Bearer "+this._token),n.headers=r,t.prototype.fetch.call(this,e,n)},e}(function(){function e(){}return e.prototype.fetch=function(e,n){return t.fetch(e,n)},e}())}).call(this,n(4))},function(t,e,n){
/*! adal-angular v1.0.17 2018-02-27 */
var r=function(){"use strict";return r=function(t){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},r.prototype._singletonInstance)return r.prototype._singletonInstance;if(r.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,t.displayCall&&"function"!=typeof t.displayCall)throw new Error("displayCall is not a function");if(!t.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(t),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(t){}}),r.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var t=this._guid();this.config.state=t,this._idTokenNonce=this._guid();var e=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);e&&""!==e?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):e=window.location.href,this.verbose("Expected state: "+t+" startPage:"+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,t,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(t),this.registerCallback(t,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},r.prototype._openPopup=function(t,e,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,u=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a=s/2-n/2+o,c=u/2-r/2+i,p=window.open(t,e,"width="+n+", height="+r+", top="+c+", left="+a);return p.focus&&p.focus(),p}catch(t){return this.warn("Error opening popup, "+t.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},r.prototype._handlePopupError=function(t,e,n,r,o){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o),e&&this._activeRenewals[e]&&(this._activeRenewals[e]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,t&&t(r,null,n)},r.prototype._loginPopup=function(t,e,n){var r=this._openPopup(t,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),o=n||this.callback;if(null!=r){if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf("#"))var i=this.config.redirectUri.split("#")[0];else i=this.config.redirectUri;var s=this,u=window.setInterval((function(){if(!r||r.closed||void 0===r.closed){var t="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return s.isAngular&&s._broadcast("adal:popUpClosed",n+s.CONSTANTS.RESOURCE_DELIMETER+t),s._handlePopupError(o,e,t,n,n),void window.clearInterval(u)}try{var a=r.location;if(-1!=encodeURI(a.href).indexOf(encodeURI(i)))return s.isAngular?s._broadcast("adal:popUpHashChanged",a.hash):s.handleWindowCallback(a.hash),window.clearInterval(u),s._loginInProgress=!1,s._acquireTokenInProgress=!1,s.info("Closing popup window"),s._openedWindows=[],void r.close()}catch(t){}}),1)}else{var a="Popup Window is null. This can happen if you are using IE";this._handlePopupError(o,e,"Error opening popup",a,a)}},r.prototype._broadcast=function(t,e){!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}if("function"==typeof window.CustomEvent)return!1;t.prototype=window.Event.prototype,window.CustomEvent=t}();var n=new CustomEvent(t,{detail:e});window.dispatchEvent(n)},r.prototype.loginInProgress=function(){return this._loginInProgress},r.prototype._hasResource=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return e&&!this._isEmpty(e)&&e.indexOf(t+this.CONSTANTS.RESOURCE_DELIMETER)>-1},r.prototype.getCachedToken=function(t){if(!this._hasResource(t))return null;var e=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?e:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0),null)},r.prototype.getCachedUser=function(){if(this._user)return this._user;var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(t),this._user},r.prototype.registerCallback=function(t,e,n){this._activeRenewals[e]=t,this._callBacksMappedToRenewStates[t]||(this._callBacksMappedToRenewStates[t]=[]);var r=this;this._callBacksMappedToRenewStates[t].push(n),this._callBackMappedToRenewStates[t]||(this._callBackMappedToRenewStates[t]=function(n,o,i,s){r._activeRenewals[e]=null;for(var u=0;u<r._callBacksMappedToRenewStates[t].length;++u)try{r._callBacksMappedToRenewStates[t][u](n,o,i,s)}catch(i){r.warn(i)}r._callBacksMappedToRenewStates[t]=null,r._callBackMappedToRenewStates[t]=null})},r.prototype._renewToken=function(t,e,n){this.info("renewToken is called for resource:"+t);var r=this._addAdalFrame("adalRenewFrame"+t),o=this._guid()+"|"+t;this.config.state=o,this._renewStates.push(o),this.verbose("Renew token Expected state: "+o),n=n||"token";var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,t),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),i+="&nonce="+encodeURIComponent(this._idTokenNonce)),i+="&prompt=none",i=this._addHintParameters(i),this.registerCallback(o,t,e),this.verbosePii("Navigate to:"+i),r.src="about:blank",this._loadFrameTimeout(i,"adalRenewFrame"+t,t)},r.prototype._renewIdToken=function(t,e){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var o=null==e?null:this.config.clientId,i=(e=e||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(e,o),"prompt"));i+="&prompt=none",i=this._addHintParameters(i),i+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,t),this.verbosePii("Navigate to:"+i),n.src="about:blank",this._loadFrameTimeout(i,"adalIdTokenFrame",this.config.clientId)},r.prototype._urlContainsQueryStringParameter=function(t,e){return new RegExp("[\\?&]"+t+"=").test(e)},r.prototype._urlRemoveQueryStringParameter=function(t,e){var n=new RegExp("(\\&"+e+"=)[^&]+");return t=t.replace(n,""),n=new RegExp("("+e+"=)[^&]+&"),t=t.replace(n,""),n=new RegExp("("+e+"=)[^&]+"),t.replace(n,"")},r.prototype._loadFrameTimeout=function(t,e,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(t,e);var r=this;setTimeout((function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var t=r._activeRenewals[n];t&&r._callBackMappedToRenewStates[t]&&r._callBackMappedToRenewStates[t]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}}),r.CONSTANTS.LOADFRAME_TIMEOUT)},r.prototype._loadFrame=function(t,e){var n=this;n.info("LoadFrame: "+e);var r=e;setTimeout((function(){var e=n._addAdalFrame(r);""!==e.src&&"about:blank"!==e.src||(e.src=t,n._loadFrame(t,r))}),500)},r.prototype.acquireToken=function(t,e){if(this._isEmpty(t))return this.warn("resource is required"),void e("resource is required",null,"resource is required");var n=this.getCachedToken(t);return n?(this.info("Token is already in cache for resource:"+t),void e(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[t]?this.registerCallback(this._activeRenewals[t],t,e):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,t===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(e)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(e,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(t,e)):(this.verbose("renewing idtoken and access_token"),this._renewToken(t,e,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void e("User login is required",null,"login required"))},r.prototype.acquireTokenPopup=function(t,e,n,r){if(this._isEmpty(t))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+t;this.config.state=o,this._renewStates.push(o),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(i+="&prompt=select_account",e&&(i+=e),n&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(n);else if(n&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this.registerCallback(o,t,r),this._loginPopup(i,t,r)},r.prototype.acquireTokenRedirect=function(t,e,n){if(this._isEmpty(t))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var o=this._guid()+"|"+t;this.config.state=o,this.verbose("Renew token Expected state: "+o);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",t),"prompt");if(i+="&prompt=select_account",e&&(i+=e),n&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(n);else if(n&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,o,!0),this.promptUser(i)},r.prototype.promptUser=function(t){t?(this.infoPii("Navigate to:"+t),window.location.replace(t)):this.info("Navigate url is empty")},r.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(t)){t=t.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var e=0;e<t.length&&""!==t[e];e++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t[e],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t[e],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},r.prototype.clearCacheForResource=function(t){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(t)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,0))},r.prototype.logOut=function(){var t;if(this.clearCache(),this._user=null,this.config.logOutUri)t=this.config.logOutUri;else{var e="common",n="";this.config.tenant&&(e=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),t=this.instance+e+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+t),this.promptUser(t)},r.prototype._isEmpty=function(t){return void 0===t||!t||0===t.length},r.prototype.getUser=function(t){if("function"!=typeof t)throw new Error("callback is not a function");if(this._user)t(null,this._user);else{var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(e)?(this.warn("User information is not available"),t("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(e),t(null,this._user))}},r.prototype._addHintParameters=function(t){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==t.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",t)||(t+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",t)||(t+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",t)&&this._user.profile.upn.indexOf("@")>-1)){var e=this._user.profile.upn.split("@");t+="&domain_hint="+encodeURIComponent(e[e.length-1])}return t},r.prototype._createUser=function(t){var e=null,n=this._extractIdToken(t);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(e={userName:"",profile:n},n.hasOwnProperty("upn")?e.userName=n.upn:n.hasOwnProperty("email")&&(e.userName=n.email)):this.warn("IdToken has invalid aud field")),e},r.prototype._getHash=function(t){return t.indexOf("#/")>-1?t=t.substring(t.indexOf("#/")+2):t.indexOf("#")>-1&&(t=t.substring(1)),t},r.prototype.isCallback=function(t){t=this._getHash(t);var e=this._deserialize(t);return e.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},r.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},r.prototype.getRequestInfo=function(t){t=this._getHash(t);var e=this._deserialize(t),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(e&&(n.parameters=e,e.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||e.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||e.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){n.valid=!0;var r;if(!e.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+e.state),r=e.state,n.stateResponse=r,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var o=this._renewStates,i=0;i<o.length;i++)if(o[i]===n.stateResponse){n.stateMatch=!0;break}}}return n},r.prototype._matchNonce=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(e){e=e.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<e.length;n++)if(e[n]===t.profile.nonce)return!0}return!1},r.prototype._matchState=function(t){var e=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(e){e=e.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<e.length;n++)if(e[n]===t.stateResponse)return t.requestType=this.REQUEST_TYPE.LOGIN,t.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r){r=r.split(this.CONSTANTS.CACHE_DELIMETER);for(n=0;n<r.length;n++)if(r[n]===t.stateResponse)return t.requestType=this.REQUEST_TYPE.RENEW_TOKEN,t.stateMatch=!0,!0}return!1},r.prototype._getResourceFromState=function(t){if(t){var e=t.indexOf("|");if(e>-1&&e+1<t.length)return t.substring(e+1)}return""},r.prototype.saveTokenFromHash=function(t){this.info("State status:"+t.stateMatch+"; Request type:"+t.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var e=this._getResourceFromState(t.stateResponse);if(t.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+t.parameters.error+"; Error description:"+t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,t.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,t.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),t.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,t.parameters.error_description));else if(t.stateMatch){var n;this.info("State is right"),t.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,t.parameters[this.CONSTANTS.SESSION_STATE]),t.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(e)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+e+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,t.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,this._expiresIn(t.parameters[this.CONSTANTS.EXPIRES_IN]))),t.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(t.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,t.parameters[this.CONSTANTS.ID_TOKEN]),e=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(e)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+e+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,t.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(t.parameters.error="invalid id_token",t.parameters.error_description="Invalid id_token. id_token: "+t.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+t.parameters[this.CONSTANTS.ID_TOKEN])))}else t.parameters.error="Invalid_state",t.parameters.error_description="Invalid_state. state: "+t.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+t.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+e,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},r.prototype.getResourceForEndpoint=function(t){if(this.config&&this.config.anonymousEndpoints)for(var e=0;e<this.config.anonymousEndpoints.length;e++)if(t.indexOf(this.config.anonymousEndpoints[e])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(t.indexOf(n)>-1)return this.config.endpoints[n];return t.indexOf("http://")>-1||t.indexOf("https://")>-1?this._getHostFromUri(t)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},r.prototype._getHostFromUri=function(t){var e=String(t).replace(/^(https?:)\/\//,"");return e.split("/")[0]},r.prototype.handleWindowCallback=function(t){if(null==t&&(t=window.location.hash),this.isCallback(t)){var e=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(e=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(e=window.parent._adalInstance);var r,o,i=e.getRequestInfo(t),s=null;o=n||window.parent!==window?e._callBackMappedToRenewStates[i.stateResponse]:e.callback,e.info("Returned from redirect url"),e.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?e.verbose("Window is in iframe, acquiring token silently"):e.verbose("acquiring token interactive in progress"),r=i.parameters[e.CONSTANTS.ACCESS_TOKEN]||i.parameters[e.CONSTANTS.ID_TOKEN],s=e.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(r=i.parameters[e.CONSTANTS.ID_TOKEN],s=e.CONSTANTS.ID_TOKEN);var u=i.parameters[e.CONSTANTS.ERROR_DESCRIPTION],a=i.parameters[e.CONSTANTS.ERROR];try{o&&o(u,r,a,s)}catch(t){e.error("Error occurred in user defined callback function: "+t)}window.parent!==window||n||(e.config.navigateToLoginRequestUrl?window.location.href=e._getItem(e.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},r.prototype._getNavigateUrl=function(t,e){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(t,this.config,e)+this._addLibMetadata();return this.info("Navigate url:"+r),r},r.prototype._extractIdToken=function(t){var e=this._decodeJwt(t);if(!e)return null;try{var n=e.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(t){this.error("The returned id_token could not be decoded",t)}return null},r.prototype._base64DecodeStringUrlSafe=function(t){return t=t.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(t))):decodeURIComponent(escape(this._decode(t)))},r.prototype._decode=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(t=String(t).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,o,i,s,u,a,c,p,l="",h=0;h<n;h+=4){if(r=e.indexOf(t.charAt(h)),o=e.indexOf(t.charAt(h+1)),i=e.indexOf(t.charAt(h+2)),s=e.indexOf(t.charAt(h+3)),h+2===n-1){a=(u=r<<18|o<<12|i<<6)>>16&255,c=u>>8&255,l+=String.fromCharCode(a,c);break}if(h+1===n-1){a=(u=r<<18|o<<12)>>16&255,l+=String.fromCharCode(a);break}a=(u=r<<18|o<<12|i<<6|s)>>16&255,c=u>>8&255,p=255&u,l+=String.fromCharCode(a,c,p)}return l},r.prototype._decodeJwt=function(t){if(this._isEmpty(t))return null;var e=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);return!e||e.length<4?(this.warn("The returned id_token is not parseable."),null):{header:e[1],JWSPayload:e[2],JWSSig:e[3]}},r.prototype._convertUrlSafeToRegularBase64EncodedString=function(t){return t.replace("-","+").replace("_","/")},r.prototype._serialize=function(t,e,n){var r=[];if(null!==e){r.push("?response_type="+t),r.push("client_id="+encodeURIComponent(e.clientId)),n&&r.push("resource="+encodeURIComponent(n)),r.push("redirect_uri="+encodeURIComponent(e.redirectUri)),r.push("state="+encodeURIComponent(e.state)),e.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(e.slice)),e.hasOwnProperty("extraQueryParameter")&&r.push(e.extraQueryParameter);var o=e.correlationId?e.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(o))}return r.join("&")},r.prototype._deserialize=function(t){var e,n=/\+/g,r=/([^&=]+)=([^&]*)/g,o=function(t){return decodeURIComponent(t.replace(n," "))},i={};for(e=r.exec(t);e;)i[o(e[1])]=o(e[2]),e=r.exec(t);return i},r.prototype._decimalToHex=function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e},r.prototype._guid=function(){var t=window.crypto||window.msCrypto;if(t&&t.getRandomValues){var e=new Uint8Array(16);return t.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,this._decimalToHex(e[0])+this._decimalToHex(e[1])+this._decimalToHex(e[2])+this._decimalToHex(e[3])+"-"+this._decimalToHex(e[4])+this._decimalToHex(e[5])+"-"+this._decimalToHex(e[6])+this._decimalToHex(e[7])+"-"+this._decimalToHex(e[8])+this._decimalToHex(e[9])+"-"+this._decimalToHex(e[10])+this._decimalToHex(e[11])+this._decimalToHex(e[12])+this._decimalToHex(e[13])+this._decimalToHex(e[14])+this._decimalToHex(e[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",o=0,i="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(o=16*Math.random()|0),"x"===n[s]?i+=r[o]:"y"===n[s]?(o&=3,i+=r[o|=8]):i+=n[s];return i},r.prototype._expiresIn=function(t){return t||(t=3599),this._now()+parseInt(t,10)},r.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},r.prototype._addAdalFrame=function(t){if(void 0!==t){this.info("Add adal frame to document:"+t);var e=document.getElementById(t);if(!e){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",t),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",e=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+t+'" id="'+t+'" style="display:none"></iframe>');window.frames&&window.frames[t]&&(e=window.frames[t])}return e}},r.prototype._saveItem=function(t,e,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var r=this._getItem(t)||"";localStorage.setItem(t,r+e+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(t,e);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(t,e),!0):(this.info("Session storage is not supported"),!1)},r.prototype._getItem=function(t){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(t):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(t):(this.info("Session storage is not supported"),null)},r.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(t){return!1}},r.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(t){return!1}},r.prototype._cloneConfig=function(t){if(null===t||"object"!=typeof t)return t;var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},r.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},r.prototype.log=function(t,e,n,r){if(t<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var o=(new Date).toUTCString(),i="";i=this.config.correlationId?o+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e:o+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[t]+" "+e,n&&(i+="\nstack:\n"+n.stack),Logging.log(i)}},r.prototype.error=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e)},r.prototype.warn=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null)},r.prototype.info=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null)},r.prototype.verbose=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null)},r.prototype.errorPii=function(t,e){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,t,e,!0)},r.prototype.warnPii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,t,null,!0)},r.prototype.infoPii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,t,null,!0)},r.prototype.verbosePii=function(t){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,t,null,!0)},r.prototype._libVersion=function(){return"1.0.17"},t.exports&&(t.exports=r,t.exports.inject=function(t){return new r(t)}),r}()},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(2),i=n(1),s=n(3);function u(t){var e=document.createElement("a");return e.href=t,e.protocol+"//"+e.hostname}var a=function(t){function e(e,n,r){var o=t.call(this,null)||this;return o.clientId=e,o.tenant=n,o.redirectUri=r,o._displayCallback=null,o._loginPromise=null,o}return r.b(e,t),e.fromSPFxContext=function(t){return new c(t)},e.prototype.fetch=function(e,n){var r=this;if(!Object(i.i)(e))throw Error("You must supply absolute urls to AdalClient.fetch.");return this.getToken(u(e)).then((function(o){return r.token=o,t.prototype.fetch.call(r,e,n)}))},e.prototype.getToken=function(t){var n=this;return new Promise((function(r,o){n.ensureAuthContext().then((function(t){return n.login()})).then((function(n){e._authContext.acquireToken(t,(function(t,e){if(t)return o(Error(t));r(e)}))})).catch(o)}))},e.prototype.ensureAuthContext=function(){var t=this;return new Promise((function(n){null===e._authContext&&(e._authContext=s.inject({clientId:t.clientId,displayCall:function(e){t._displayCallback&&t._displayCallback(e)},navigateToLoginRequestUrl:!1,redirectUri:t.redirectUri,tenant:t.tenant})),n()}))},e.prototype.login=function(){var t=this;return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise((function(n,r){if(e._authContext.getCachedUser())return n();t._displayCallback=function(o){var i=window.open(o,"login","width=483, height=600");if(!i)return r(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));i&&i.focus&&i.focus();var s=window.setInterval((function(){i&&!i.closed&&void 0!==i.closed||window.clearInterval(s);try{-1!==i.document.URL.indexOf(t.redirectUri)&&(window.clearInterval(s),e._authContext.handleWindowCallback(i.location.hash),i.close(),n())}catch(t){r(t)}}),30)},t.ensureAuthContext().then((function(n){e._authContext._loginInProgress=!1,e._authContext.login(),t._displayCallback=null}))})),this._loginPromise)},e._authContext=null,e}(o.a),c=function(t){function e(e){var n=t.call(this,null)||this;return n.context=e,n}return r.b(e,t),e.prototype.fetch=function(e,n){var r=this;return this.getToken(u(e)).then((function(o){return r.token=o,t.prototype.fetch.call(r,e,n)}))},e.prototype.getToken=function(t){return this.context.aadTokenProviderFactory.getTokenProvider().then((function(e){return e.getToken(t)}))},e}(o.a),p=Object(i.h)(Object.entries)?Object.entries:function(t){return Object.keys(t).map((function(e){return[e,t[e]]}))};var l,h=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext"],f=new(function(){function t(t){void 0===t&&(t=new Map),this._v=t,this._v.set(h[0],"session"),this._v.set(h[1],60),this._v.set(h[2],!1),this._v.set(h[3],!1),this._v.set(h[4],750),this._v.set(h[5],null)}return t.prototype.extend=function(t){var e;this._v=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)e[r].forEach((function(e,n){t.set(n,e)}));return t}(this._v,null!=(e=t)?new Map(p(e)):new Map)},t.prototype.get=function(t){return this._v.get(t)},Object.defineProperty(t.prototype,"defaultCachingStore",{get:function(){return this.get(h[0])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(h[1])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalCacheDisable",{get:function(){return this.get(h[2])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableCacheExpiration",{get:function(){return this.get(h[3])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(h[4])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spfxContext",{get:function(){return this.get(h[5])},enumerable:!0,configurable:!0}),t}()),d=function(){function t(t,e){void 0===e&&(e=-1),this.store=t,this.defaultTimeoutMinutes=e,this.enabled=this.test(),f.enableCacheExpiration&&this.cacheExpirationHandler()}return t.prototype.get=function(t){if(!this.enabled)return null;var e=this.store.getItem(t);if(!Object(i.k)(e))return null;var n=JSON.parse(e);return new Date(n.expiration)<=new Date?(this.delete(t),null):n.value},t.prototype.put=function(t,e,n){this.enabled&&this.store.setItem(t,this.createPersistable(e,n))},t.prototype.delete=function(t){this.enabled&&this.store.removeItem(t)},t.prototype.getOrPut=function(t,e,n){var r=this;if(!this.enabled)return e();var o=this.get(t);return null===o?e().then((function(e){return r.put(t,e,n),e})):Promise.resolve(o)},t.prototype.deleteExpired=function(){var t=this;return new Promise((function(e,n){t.enabled||e();try{for(var r=0;r<t.store.length;r++){var o=t.store.key(r);null!==o&&/["|']?pnp["|']? ?: ?1/i.test(t.store.getItem(o))&&t.get(o)}e()}catch(t){n(t)}}))},t.prototype.test=function(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(t){return!1}},t.prototype.createPersistable=function(t,e){if(void 0===e){var n=f.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),e=Object(i.b)(new Date,"second",n)}return Object(i.j)({pnp:1,expiration:e,value:t})},t.prototype.cacheExpirationHandler=function(){var t=this;this.deleteExpired().then((function(e){setTimeout(Object(i.d)(t,t.cacheExpirationHandler),f.cacheExpirationIntervalMilliseconds)})).catch((function(t){console.error(t)}))},t}(),y=function(){function t(t){void 0===t&&(t=new Map),this._store=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this._store.size},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._store.clear()},t.prototype.getItem=function(t){return this._store.get(t)},t.prototype.key=function(t){return Array.from(this._store)[t][0]},t.prototype.removeItem=function(t){this._store.delete(t)},t.prototype.setItem=function(t,e){this._store.set(t,e)},t}(),b=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._local=t,this._session=e}return Object.defineProperty(t.prototype,"local",{get:function(){return null===this._local&&(this._local=this.getStore("local")),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"session",{get:function(){return null===this._session&&(this._session=this.getStore("session")),this._session},enumerable:!0,configurable:!0}),t.prototype.getStore=function(t){return new d("local"===t?"undefined"==typeof localStorage?new y:localStorage:"undefined"==typeof sessionStorage?new y:sessionStorage)},t}(),g=function(){function t(t){this.key=t,this.expiration=Object(i.b)(new Date,"second",f.defaultCachingTimeoutSeconds),this.storeName=f.defaultCachingStore}return Object.defineProperty(t.prototype,"store",{get:function(){return"local"===this.storeName?t.storage.local:t.storage.session},enumerable:!0,configurable:!0}),t.storage=new b,t}(),O=function(){function t(t,e){this.parser=t,this.cacheOptions=e}return t.prototype.parse=function(t){var e=this;return this.parser.parse(t).then((function(t){return e.cacheData(t)}))},t.prototype.cacheData=function(t){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,t,this.cacheOptions.expiration),t},t}(),T=function(t){function e(e,n,r,o){void 0===r&&(r=n.status),void 0===o&&(o=n.statusText);var i=t.call(this,e)||this;return i.response=n,i.status=r,i.statusText=o,i.isHttpRequestError=!0,i}return r.b(e,t),e.init=function(t){return t.clone().text().then((function(n){return new e("Error making HttpClient request in queryable ["+t.status+"] "+t.statusText+" ::> "+n,t.clone())}))},e}(Error),m=function(){function t(){this.rawJson={}}return t.prototype.parse=function(t){var e=this;return new Promise((function(n,r){e.handleError(t,r)&&e.parseImpl(t,n,r)}))},t.prototype.parseImpl=function(t,e,n){var r=this;t.headers.has("Content-Length")&&0===parseFloat(t.headers.get("Content-Length"))||204===t.status?e({}):t.text().then((function(t){return t.replace(/\s/gi,"").length>0?JSON.parse(t):{}})).then((function(t){return e(r.parseODataJSON(t))})).catch((function(t){return n(t)}))},t.prototype.handleError=function(t,e){return t.ok||T.init(t).then(e),t.ok},t.prototype.parseODataJSON=function(t){this.rawJson=t;var e=t;return Object(i.f)(t,"d")?e=Object(i.f)(t.d,"results")?t.d.results:t.d:Object(i.f)(t,"value")&&(e=t.value),e},t}(),_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(m),S=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.b(e,t),e.prototype.parseImpl=function(t,e){t.text().then(e)}}(m),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.parseImpl=function(t,e){t.blob().then(e)},e}(m)),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.parseImpl=function(t,e){t.json().then(e)},e}(m),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.parseImpl=function(t,e){Object(i.h)(t.arrayBuffer)?t.arrayBuffer().then(e):t.buffer().then(e)},e}(m),w=(function(t){function e(e){var n=t.call(this)||this;return n.parser=e,n}r.b(e,t),e.prototype.parseImpl=function(t,e){this.parser(t).then(e)}}(m),function(){function t(){}return Object.defineProperty(t,"activeLogLevel",{get:function(){return t.instance.activeLogLevel},set:function(e){t.instance.activeLogLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"instance",{get:function(){return void 0!==t._instance&&null!==t._instance||(t._instance=new N),t._instance},enumerable:!0,configurable:!0}),t.subscribe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.map((function(e){return t.instance.subscribe(e)}))},t.clearSubscribers=function(){return t.instance.clearSubscribers()},Object.defineProperty(t,"count",{get:function(){return t.instance.count},enumerable:!0,configurable:!0}),t.write=function(e,n){void 0===n&&(n=1),t.instance.log({level:n,message:e})},t.writeJSON=function(t,e){void 0===e&&(e=1),this.write(JSON.stringify(t),e)},t.log=function(e){t.instance.log(e)},t.error=function(e){t.instance.log({data:e,level:3,message:e.message})},t}()),N=function(){function t(t,e){void 0===t&&(t=2),void 0===e&&(e=[]),this.activeLogLevel=t,this.subscribers=e}return t.prototype.subscribe=function(t){this.subscribers.push(t)},t.prototype.clearSubscribers=function(){var t=this.subscribers.slice(0);return this.subscribers.length=0,t},Object.defineProperty(t.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),t.prototype.write=function(t,e){void 0===e&&(e=1),this.log({level:e,message:t})},t.prototype.log=function(t){void 0!==t&&this.activeLogLevel<=t.level&&this.subscribers.map((function(e){return e.log(t)}))},t}();!function(t){t[t.Verbose=0]="Verbose",t[t.Info=1]="Info",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Off=99]="Off"}(l||(l={}));(function(){function t(){}t.prototype.log=function(t){var e=this.format(t);switch(t.level){case 0:case 1:console.log(e);break;case 2:console.warn(e);break;case 3:console.error(e)}},t.prototype.format=function(t){var e=[];if(e.push("Message: "+t.message),void 0!==t.data)try{e.push(" Data: "+JSON.stringify(t.data))}catch(t){e.push(" Data: Error in stringify of supplied data "+t)}return e.join("")}})(),function(){function t(t){this.method=t}t.prototype.log=function(t){this.method(t)}}();function C(t,e){return new Promise((function(n){t.result=e,t.hasResult=!0,n(t)}))}function I(t){return t.pipeline.length>0?t.pipeline.shift()(t):Promise.resolve(t)}function R(t){t.pipeline.length<1&&w.write("["+t.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",2);var e=I(t).then((function(t){return function(t){return w.log({data:0===w.activeLogLevel?t.result:{},level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(t.result)}(t)})).catch((function(t){throw w.error(t),t}));return t.isBatched&&t.batch.addResolveBatchDependency(e),e}function j(t){return void 0===t&&(t=!1),function(e,n,r){var o=r.value;r.value=function(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];return!t&&r.length>0&&Object(i.f)(r[0],"hasResult")&&r[0].hasResult?(w.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",0),Promise.resolve(r[0])):(w.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",0),o.apply(e,r).then((function(t){return I(t)})))}}}var A=function(){function t(){}return t.logStart=function(t){return new Promise((function(e){w.log({data:1===w.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Beginning "+t.verb+" request ("+t.requestAbsoluteUrl+")"}),e(t)}))},t.caching=function(t){return new Promise((function(e){if(t.isCached){w.write("["+t.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var n=new g(t.requestAbsoluteUrl.toLowerCase());if(void 0!==t.cachingOptions&&(n=Object(i.c)(n,t.cachingOptions)),null!==n.store){var r=n.store.get(n.key);if(null!==r)return w.log({data:1===w.activeLogLevel?{}:r,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),Object(i.h)(t.batchDependency)&&t.batchDependency(),Object(i.f)(t.parser,"hydrate")&&(r=t.parser.hydrate(r)),C(t,r).then((function(t){return e(t)}))}w.write("["+t.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),t.parser=new O(t.parser,n)}return e(t)}))},t.send=function(t){return new Promise((function(e,n){if(t.isBatched){var r=t.batch.add(t.requestAbsoluteUrl,t.verb,t.options,t.parser,t.requestId);Object(i.h)(t.batchDependency)&&t.batchDependency(),w.write("["+t.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+t.batch.batchId+".",1),e(C(t,r))}else{w.write("["+t.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var o=t.clientFactory(),s=Object(i.c)(t.options||{},{method:t.verb});o.fetch(t.requestAbsoluteUrl,s).then((function(e){return t.parser.parse(e)})).then((function(e){return C(t,e)})).then((function(t){return e(t)})).catch((function(t){return n(t)}))}}))},t.logEnd=function(t){return new Promise((function(e){t.isBatched?w.log({data:1===w.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") "+t.verb+" request will complete in batch "+t.batch.batchId+"."}):w.log({data:1===w.activeLogLevel?{}:t,level:1,message:"["+t.requestId+"] ("+(new Date).getTime()+") Completing "+t.verb+" request."}),e(t)}))},r.a([j(!0)],t,"logStart",null),r.a([j()],t,"caching",null),r.a([j()],t,"send",null),r.a([j(!0)],t,"logEnd",null),t}();var P=function(t){function e(){var e=t.call(this)||this;return e._batch=null,e._batchDependency=null,e}return r.b(e,t),e.prototype.inBatch=function(t){if(null!==this.batch)throw Error("This query is already part of a batch.");return Object(i.k)(t)&&(this._batch=t),this},e.prototype.toUrl=function(){return this._url},e.prototype.get=function(t,e){return void 0===t&&(t=new _),void 0===e&&(e={}),this.getCore(t,e)},e.prototype.getCore=function(e,n){return void 0===e&&(e=new _),void 0===n&&(n={}),t.prototype.getCore.call(this,e,n)},e.prototype.postCore=function(e,n){return void 0===e&&(e={}),void 0===n&&(n=new _),t.prototype.postCore.call(this,e,n)},e.prototype.patchCore=function(e,n){return void 0===e&&(e={}),void 0===n&&(n=new _),t.prototype.patchCore.call(this,e,n)},e.prototype.deleteCore=function(e,n){return void 0===e&&(e={}),void 0===n&&(n=new _),t.prototype.deleteCore.call(this,e,n)},e.prototype.putCore=function(e,n){return void 0===e&&(e={}),void 0===n&&(n=new _),t.prototype.putCore.call(this,e,n)},e.prototype.reqImpl=function(e,n,r){return void 0===n&&(n={}),this.hasBatch&&(this._batchDependency=this.addBatchDependency()),t.prototype.reqImpl.call(this,e,n,r)},e.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(e.prototype,"hasBatch",{get:function(){return Object(i.k)(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),e.prototype._clone=function(e,n){return e=t.prototype._clone.call(this,e,n),n.includeBatch&&(e=e.inBatch(this._batch)),e},e}(function(){function t(){this._query=new Map,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null,this._cloneParentWasCaching=!1,this._cloneParentCacheOptions=null,this._requestPipeline=null}return t.prototype.toUrl=function(){return this._url},t.prototype.concat=function(t){return this._url+=t,this},Object.defineProperty(t.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),t.prototype.configure=function(t){return Object(o.c)(this._options,t),this},t.prototype.configureFrom=function(t){return Object(o.c)(this._options,t._options),this},t.prototype.usingCaching=function(t){return f.globalCacheDisable||(this._useCaching=!0,void 0!==t&&(this._cachingOptions=t)),this},t.prototype.withPipeline=function(t){return this._requestPipeline=t.slice(0),this},t.prototype.getCore=function(t,e){return void 0===t&&(t=new v),void 0===e&&(e={}),this._cloneParentWasCaching&&this.usingCaching(this._cloneParentCacheOptions),this.reqImpl("GET",e,t)},t.prototype.postCore=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=new v),this.reqImpl("POST",t,e)},t.prototype.patchCore=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=new v),this.reqImpl("PATCH",t,e)},t.prototype.deleteCore=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=new v),this.reqImpl("DELETE",t,e)},t.prototype.putCore=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=new v),this.reqImpl("PUT",t,e)},t.prototype.reqImpl=function(t,e,n){var r=this;return void 0===e&&(e={}),this.getRequestPipeline(t,e,n).then((function(o){return r.toRequestContext(t,e,n,o)})).then((function(t){return R(t)}))},t.prototype.append=function(t){this._url=Object(i.a)(this._url,t)},Object.defineProperty(t.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),t.prototype.extend=function(t,e){this._parentUrl=t._url,this._url=Object(i.a)(this._parentUrl,e||""),this.configureFrom(t)},t.prototype._clone=function(t,e){return t.configureFrom(this),this._useCaching&&(t._cloneParentWasCaching=!0,t._cloneParentCacheOptions=this._cachingOptions),t},t.prototype.getRequestPipeline=function(t,e,n){var r=this;return void 0===e&&(e={}),new Promise((function(t){Object(i.k)(r._requestPipeline)&&Object(i.g)(r._requestPipeline)?t(r._requestPipeline):t([A.logStart,A.caching,A.send,A.logEnd].slice(0))}))},t}()),k=function(){function t(t){void 0===t&&(t=Object(i.e)()),this._batchId=t,this._reqs=[],this._deps=[],this._rDeps=[]}return Object.defineProperty(t.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requests",{get:function(){return this._reqs},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e,n,r,o){var i={id:o,method:e.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:t},s=new Promise((function(t,e){i.resolve=t,i.reject=e}));return this._reqs.push(i),s},t.prototype.addDependency=function(){var t=function(){};return this._deps.push(new Promise((function(e){t=e}))),t},t.prototype.addResolveBatchDependency=function(t){this._rDeps.push(t)},t.prototype.execute=function(){var t=this;return Promise.all(this._deps).then((function(){return Promise.all(t._deps)})).then((function(){return t.executeImpl()})).then((function(){return Promise.all(t._rDeps)})).then((function(){}))},t}();var x=new(function(){function t(){}return Object.defineProperty(t.prototype,"headers",{get:function(){var t=f.get("graph");return null!=t&&void 0!==t.headers?t.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fetchClientFactory",{get:function(){var t=f.get("graph");if(null!=t&&void 0!==t.fetchClientFactory)return t.fetchClientFactory;if(void 0!==f.spfxContext)return function(){return a.fromSPFxContext(f.spfxContext)};throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.")},enumerable:!0,configurable:!0}),t}()),G=function(){function t(){this._impl=x.fetchClientFactory()}return t.prototype.fetch=function(t,e){void 0===e&&(e={});var n=new Headers;Object(o.b)(n,x.headers),Object(o.b)(n,e.headers),n.has("Content-Type")||n.append("Content-Type","application/json"),n.has("SdkVersion")||n.append("SdkVersion","PnPCoreJS/1.3.7");var r=Object(i.c)(e,{headers:n});return this.fetchRaw(t,r)},t.prototype.fetchRaw=function(t,e){var n=this;void 0===e&&(e={});var r=new Headers;Object(o.b)(r,e.headers),e=Object(i.c)(e,{headers:r});var s=function(r){n._impl.fetch(t,e).then((function(t){return r.resolve(t)})).catch((function(t){429!==t.status&&503!==t.status&&r.reject(t);var e=r.delay;r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(t),setTimeout(Object(i.d)(n,s,r),e)}))};return new Promise((function(t,e){var r={attempts:0,delay:100,reject:e,resolve:t,retryCount:7};s.call(n,r)}))},t.prototype.get=function(t,e){void 0===e&&(e={});var n=Object(i.c)(e,{method:"GET"});return this.fetch(t,n)},t.prototype.post=function(t,e){void 0===e&&(e={});var n=Object(i.c)(e,{method:"POST"});return this.fetch(t,n)},t.prototype.patch=function(t,e){void 0===e&&(e={});var n=Object(i.c)(e,{method:"PATCH"});return this.fetch(t,n)},t.prototype.delete=function(t,e){void 0===e&&(e={});var n=Object(i.c)(e,{method:"DELETE"});return this.fetch(t,n)},t}(),U=function(){function t(){}return t.ensure=function(e,n){var r=[t.Beta,t.V1],o=new RegExp(n,"i"),i=r.filter((function(t){return!o.test(t)})).map((function(t){return t.replace(".","\\.")}));return o=new RegExp("/?("+i.join("|")+")/","ig"),e.replace(o,"/"+n+"/")},t.Beta="beta",t.V1="v1.0",t}(),L=function(t){function e(e,n){var r=t.call(this)||this;if("string"==typeof e){var o=e;r._parentUrl=o,r._url=Object(i.a)(o,n)}else r.extend(e,n);return r}return r.b(e,t),e.prototype.select=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this.query.set("$select",t.join(",")),this},e.prototype.expand=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>0&&this.query.set("$expand",t.join(",")),this},e.prototype.as=function(t){var e=new t(this._url,null);return Object(i.c)(e,this,!0)},e.prototype.toUrlAndQuery=function(){var t=this.toUrl();if(Object(i.i)(t)||(t=Object(i.a)("https://graph.microsoft.com",t)),this.query.size>0){var e=t.indexOf("?")>-1?"&":"?";t+=""+e+Array.from(this.query).map((function(t){return t[0]+"="+t[1]})).join("&")}return t},e.prototype.setEndpoint=function(t){return this._url=U.ensure(this._url,t),this},e.prototype.getParent=function(t,e,n){return void 0===e&&(e=this.parentUrl),new t(e,n)},e.prototype.clone=function(e,n,r){return void 0===r&&(r=!0),t.prototype._clone.call(this,new e(this,n),{includeBatch:r})},e.prototype.toRequestContext=function(t,e,n,r){void 0===e&&(e={});var o=this.hasBatch?this._batchDependency:function(){};return Promise.resolve({batch:this.batch,batchDependency:o,cachingOptions:this._cachingOptions,clientFactory:function(){return new G},isBatched:this.hasBatch,isCached:/^get$/i.test(t)&&this._useCaching,options:e,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:Object(i.e)(),verb:t})},e}(P),q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.filter=function(t){return this.query.set("$filter",t),this},e.prototype.orderBy=function(t,e){void 0===e&&(e=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(t+" "+(e?"asc":"desc")),this.query.set(n,r.join(",")),this},e.prototype.top=function(t){return this.query.set("$top",t.toString()),this},e.prototype.skip=function(t){return this.query.set("$skip",t.toString()),this},e.prototype.skipToken=function(t){return this.query.set("$skiptoken",t),this},Object.defineProperty(e.prototype,"count",{get:function(){return this.query.set("$count","true"),this},enumerable:!0,configurable:!0}),e}(L),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.search=function(t){return this.query.set("$search",t),this},e}(q),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(L);function B(t){return function(e){return function(e){function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.call(this,n[0],n.length>1&&void 0!==n[1]?n[1]:t)||this}return r.b(n,e),n}(e)}}var K,F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r.b(e,t),n=e,e.prototype.add=function(t){return this.clone(n,"$ref").postCore({body:Object(i.j)({"@odata.id":t})})},e.prototype.getById=function(t){return new W(this,t)},e=n=r.a([B("members")],e)}(q),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.remove=function(){return this.clone(e,"$ref").deleteCore()},e}(M),H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("owners")],e)}(F),Q=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}r.b(e,t),e=r.a([B("calendars")],e)}(q),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"events",{get:function(){return new Y(this)},enumerable:!0,configurable:!0}),e}(M)),Y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new V(this,t)},e.prototype.add=function(t){var e=this;return this.postCore({body:Object(i.j)(t)}).then((function(t){return{data:t,event:e.getById(t.id)}}))},e=r.a([B("events")],e)}(q),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e.prototype.delete=function(){return this.deleteCore()},e}(M),$=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new J(this,t)},e.prototype.addFile=function(t,e){return this.postCore({body:Object(i.j)({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:e,name:t})})},e=r.a([B("attachments")],e)}(q),J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(M),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.add=function(t){return this.postCore({body:Object(i.j)(t)})},e.prototype.getById=function(t){return new tt(this,t)},e=r.a([B("conversations")],e)}(q),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new et(this,t)},e.prototype.add=function(t){return this.postCore({body:Object(i.j)(t)})},e=r.a([B("threads")],e)}(q),Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new nt(this,t)},e.prototype.add=function(t){return this.postCore({body:Object(i.j)(t)})},e=r.a([B("posts")],e)}(q),tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"threads",{get:function(){return new X(this)},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e.prototype.delete=function(){return this.deleteCore()},e}(M),et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"posts",{get:function(){return new Z(this)},enumerable:!0,configurable:!0}),e.prototype.reply=function(t){return this.clone(e,"reply").postCore({body:Object(i.j)({post:t})})},e.prototype.delete=function(){return this.deleteCore()},e}(M),nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"attachments",{get:function(){return new $(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.forward=function(t){return this.clone(e,"forward").postCore({body:Object(i.j)(t)})},e.prototype.reply=function(t){return this.clone(e,"reply").postCore({body:Object(i.j)({post:t})})},e}(M),rt=function(t){function e(e,n){return t.call(this,e,n)||this}return r.b(e,t),e.prototype.add=function(t){return this.clone(e,"$ref").postCore({body:Object(i.j)({"@odata.id":t})})},e.prototype.remove=function(t){var n=this.clone(e,"$ref");return n.query.set("$id",t),n.deleteCore()},e}(q),ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"plans",{get:function(){return new it(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tasks",{get:function(){return new ut(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buckets",{get:function(){return new ct(this)},enumerable:!0,configurable:!0}),e=r.a([B("planner")],e)}(M),it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new st(this,t)},e.prototype.add=function(t,e){var n=this,r={owner:t,title:e};return this.postCore({body:Object(i.j)(r)}).then((function(t){return{data:t,plan:n.getById(t.id)}}))},e=r.a([B("plans")],e)}(q),st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"tasks",{get:function(){return new ut(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buckets",{get:function(){return new ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"details",{get:function(){return new lt(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t,e){return void 0===e&&(e="*"),this.patchCore({body:Object(i.j)(t),headers:{"If-Match":e}})},e}(M),ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new at(this,t)},e.prototype.add=function(t,e,n,r){var o=this,s=Object(i.c)({planId:t,title:e},n);return r&&(s=Object(i.c)(s,{bucketId:r})),this.postCore({body:Object(i.j)(s)}).then((function(t){return{data:t,task:o.getById(t.id)}}))},e=r.a([B("tasks")],e)}(q),at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t,e){return void 0===e&&(e="*"),this.patchCore({body:Object(i.j)(t),headers:{"If-Match":e}})},Object.defineProperty(e.prototype,"details",{get:function(){return new lt(this)},enumerable:!0,configurable:!0}),e}(M),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.add=function(t,e,n){var r=this,o={name:t,orderHint:n||"",planId:e};return this.postCore({body:Object(i.j)(o)}).then((function(t){return{bucket:r.getById(t.id),data:t}}))},e.prototype.getById=function(t){return new pt(this,t)},e=r.a([B("buckets")],e)}(q),pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t,e){return void 0===e&&(e="*"),this.patchCore({body:Object(i.j)(t),headers:{"If-Match":e}})},Object.defineProperty(e.prototype,"tasks",{get:function(){return new ut(this)},enumerable:!0,configurable:!0}),e}(M),lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("details")],e)}(q),ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r.b(e,t),n=e,e.prototype.getBlob=function(){return this.clone(n,"$value",!1).get(new S)},e.prototype.getBuffer=function(){return this.clone(n,"$value",!1).get(new E)},e.prototype.setContent=function(t){return this.clone(n,"$value",!1).patchCore({body:t})},e=n=r.a([B("photo")],e)}(M),ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.create=function(t,e,n,r,o){void 0===n&&(n=""),void 0===o&&(o={});var i={description:n&&n.length>0?n:"","owners@odata.bind":["https://graph.microsoft.com/v1.0/users/"+r]};return Ce.groups.add(t,e,K.Office365,i).then((function(t){return t.group.createTeam(o).then((function(e){return{data:e,group:t.group,team:new dt(t.group)}}))}))},e.prototype.getById=function(t){return new dt(this,t)},e=r.a([B("teams")],e)}(q),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r.b(e,t),n=e,Object.defineProperty(e.prototype,"channels",{get:function(){return new yt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"installedApps",{get:function(){return new gt(this)},enumerable:!0,configurable:!0}),e.prototype.update=function(t){var e=this;return this.clone(n,"").patchCore({body:Object(i.j)(t)}).then((function(t){return{data:t,team:e}}))},e.prototype.archive=function(t){var e,r=this;return null!=t&&(e=Object(i.c)(e,{shouldSetSpoSiteReadOnlyForMembers:t})),this.clone(n,"archive").postCore({body:Object(i.j)(e)}).then((function(t){return{data:t,team:r}}))},e.prototype.unarchive=function(){var t=this;return this.clone(n,"unarchive").postCore({}).then((function(e){return{data:e,team:t}}))},e.prototype.cloneTeam=function(t,e,r,o,s){var u=this;void 0===r&&(r="");var a={description:r||"",displayName:t,mailNickname:e,partsToClone:o,visibility:s};return this.clone(n,"clone").postCore({body:Object(i.j)(a)}).then((function(t){return{data:t,team:u}}))},e.prototype.get=function(t,e){return void 0===t&&(t=new _),void 0===e&&(e={}),this.clone(n,"").getCore(t,e)},e=n=r.a([B("team")],e)}(M),yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.create=function(t,e){var n=this;void 0===e&&(e="");var r={description:e&&e.length>0?e:"",displayName:t};return this.postCore({body:Object(i.j)(r)}).then((function(t){return{channel:n.getById(t.id),data:t}}))},e.prototype.getById=function(t){return new bt(this,t)},e=r.a([B("channels")],e)}(q),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"tabs",{get:function(){return new Ot(this)},enumerable:!0,configurable:!0}),e}(M),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.add=function(t){var e={"teamsApp@odata.bind":t};return this.postCore({body:Object(i.j)(e)}).then((function(t){return{data:t}}))},e.prototype.remove=function(){return this.deleteCore()},e=r.a([B("installedApps")],e)}(q),Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.add=function(t,e,n){var r=this,o=Object(i.c)({name:t,"teamsApp@odata.bind":e},n);return this.postCore({body:Object(i.j)(o)}).then((function(t){return{data:t,tab:r.getById(t.id)}}))},e.prototype.getById=function(t){return new Tt(this,t)},e=r.a([B("tabs")],e)}(q),Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r.b(e,t),n=e,e.prototype.update=function(t){var e=this;return this.clone(n,"").patchCore({body:Object(i.j)(t)}).then((function(t){return{data:t,tab:e}}))},e.prototype.remove=function(){return this.deleteCore()},e=n=r.a([B("tab")],e)}(M);!function(t){t[t.Office365=0]="Office365",t[t.Dynamic=1]="Dynamic",t[t.Security=2]="Security"}(K||(K={}));var mt,_t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new St(this,t)},e.prototype.add=function(t,e,n,r){var o=this;void 0===r&&(r={});var s=Object(i.c)({displayName:t,mailEnabled:n===K.Office365,mailNickname:e,securityEnabled:n!==K.Office365},r);return n!==K.Security&&(s=Object(i.c)(s,{groupTypes:n===K.Office365?["Unified"]:["DynamicMembership"]})),this.postCore({body:Object(i.j)(s)}).then((function(t){return{data:t,group:o.getById(t.id)}}))},e=r.a([B("groups")],e)}(q),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"calendar",{get:function(){return new Q(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){return new Y(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owners",{get:function(){return new H(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"plans",{get:function(){return new it(this,"planner/plans")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"members",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conversations",{get:function(){return new z(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"acceptedSenders",{get:function(){return new rt(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rejectedSenders",{get:function(){return new rt(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"photo",{get:function(){return new ht(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"team",{get:function(){return new dt(this)},enumerable:!0,configurable:!0}),e.prototype.addFavorite=function(){return this.clone(e,"addFavorite").postCore()},e.prototype.createTeam=function(t){return this.clone(e,"team").putCore({body:Object(i.j)(t)})},e.prototype.getMemberObjects=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberObjects").postCore({body:Object(i.j)({securityEnabledOnly:t})})},e.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberGroups").postCore({body:Object(i.j)({securityEnabledOnly:t})})},e.prototype.checkMemberGroups=function(t){return this.clone(e,"checkMemberGroups").postCore({body:Object(i.j)({groupIds:t})})},e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e.prototype.removeFavorite=function(){return this.clone(e,"removeFavorite").postCore()},e.prototype.resetUnseenCount=function(){return this.clone(e,"resetUnseenCount").postCore()},e.prototype.subscribeByMail=function(){return this.clone(e,"subscribeByMail").postCore()},e.prototype.unsubscribeByMail=function(){return this.clone(e,"unsubscribeByMail").postCore()},e.prototype.getCalendarView=function(t,n){var r=this.clone(e,"calendarView");return r.query.set("startDateTime",t.toISOString()),r.query.set("endDateTime",n.toISOString()),r.get()},e}(M),vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new Et(this,t)},e.prototype.add=function(t,e,n,r,o){var s=this;void 0===o&&(o={});var u=Object(i.c)({businessPhones:r,emailAddresses:n,givenName:t,surName:e},o);return this.postCore({body:Object(i.j)(u)}).then((function(t){return{contact:s.getById(t.id),data:t}}))},e=r.a([B("contacts")],e)}(q),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e}(M),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new Nt(this,t)},e.prototype.add=function(t,e){var n=this,r={displayName:t,parentFolderId:e};return this.postCore({body:Object(i.j)(r)}).then((function(t){return{contactFolder:n.getById(t.id),data:t}}))},e=r.a([B("contactFolders")],e)}(q),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"contacts",{get:function(){return new vt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childFolders",{get:function(){return new wt(this,"childFolders")},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e}(M),Ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"notebooks",{get:function(){return new It(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sections",{get:function(){return new jt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pages",{get:function(){return new Pt(this)},enumerable:!0,configurable:!0}),e=r.a([B("onenote")],e)}(M),It=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new Rt(this,t)},e.prototype.add=function(t){var e=this,n={displayName:t};return this.postCore({body:Object(i.j)(n)}).then((function(t){return{data:t,notebook:e.getById(t.id)}}))},e=r.a([B("notebooks")],e)}(q),Rt=function(t){function e(e,n){return t.call(this,e,n)||this}return r.b(e,t),Object.defineProperty(e.prototype,"sections",{get:function(){return new jt(this)},enumerable:!0,configurable:!0}),e}(M),jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new At(this,t)},e.prototype.add=function(t){var e=this,n={displayName:t};return this.postCore({body:Object(i.j)(n)}).then((function(t){return{data:t,section:e.getById(t.id)}}))},e=r.a([B("sections")],e)}(q),At=function(t){function e(e,n){return t.call(this,e,n)||this}return r.b(e,t),e}(M),Pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("pages")],e)}(q),kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new xt(this,t)},e=r.a([B("drives")],e)}(q),xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"root",{get:function(){return new Gt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return new Ut(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return new Dt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recent",{get:function(){return new Mt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharedWithMe",{get:function(){return new Bt(this)},enumerable:!0,configurable:!0}),e=r.a([B("drive")],e)}(M),Gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return new qt(this)},enumerable:!0,configurable:!0}),e.prototype.search=function(t){return new Kt(this,"search(q='"+t+"')")},e=r.a([B("root")],e)}(M),Ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new Lt(this,t)},e=r.a([B("items")],e)}(q),Lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return new qt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"thumbnails",{get:function(){return new Ft(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e.prototype.move=function(t,e){var n=Object(i.c)({},t);return e&&(n=Object(i.c)({},e)),this.patchCore({body:Object(i.j)(n)})},e}(M),qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.add=function(t,e){var n=this,r=Object(i.c)({name:t},e);return this.postCore({body:Object(i.j)(r)}).then((function(t){return{data:t,driveItem:new Lt(n,t.id)}}))},e=r.a([B("children")],e)}(q),Dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("list")],e)}(q),Mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("recent")],e)}(M),Bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("sharedWithMe")],e)}(M),Kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("search")],e)}(M),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("thumbnails")],e)}(M),Wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new Ht(this,t)},e.prototype.add=function(t){return this.postCore({body:Object(i.j)(t)})},e=r.a([B("messages")],e)}(q),Ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(M),Qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new Yt(this,t)},e.prototype.add=function(t){return this.postCore({body:Object(i.j)(t)})},e=r.a([B("mailFolders")],e)}(q),Yt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(M),Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e=r.a([B("mailboxSettings")],e)}(M);!function(t){t[t.directoryObject=0]="directoryObject",t[t.user=1]="user",t[t.group=2]="group",t[t.device=3]="device"}(mt||(mt={}));var $t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r.b(e,t),n=e,e.prototype.getById=function(t){return new Jt(this,t)},e.prototype.getByIds=function(t,e){return void 0===e&&(e=mt.directoryObject),this.clone(n,"getByIds").postCore({body:Object(i.j)({ids:t,type:e})})},e=n=r.a([B("directoryObjects")],e)}(q),Jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.getMemberObjects=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberObjects").postCore({body:Object(i.j)({securityEnabledOnly:t})})},e.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberGroups").postCore({body:Object(i.j)({securityEnabledOnly:t})})},e.prototype.checkMemberGroups=function(t){return this.clone(e,"checkMemberGroups").postCore({body:Object(i.j)({groupIds:t})})},e}(M),zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("people")],e)}(q),Xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"trending",{get:function(){return new Zt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"used",{get:function(){return new te(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shared",{get:function(){return new ee(this)},enumerable:!0,configurable:!0}),e=r.a([B("insights")],e)}(M),Zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("trending")],e)}(q),te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("used")],e)}(q),ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("shared")],e)}(q),ne=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new re(this,t)},e=r.a([B("users")],e)}(q),re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"onenote",{get:function(){return new Ct(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contacts",{get:function(){return new vt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calendar",{get:function(){return new Q(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"photo",{get:function(){return new ht(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"joinedTeams",{get:function(){return new ft(this,"joinedTeams")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"memberOf",{get:function(){return new $t(this,"memberOf")},enumerable:!0,configurable:!0}),e.prototype.getMemberObjects=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberObjects").postCore({body:Object(i.j)({securityEnabledOnly:t})})},e.prototype.getMemberGroups=function(t){return void 0===t&&(t=!1),this.clone(e,"getMemberGroups").postCore({body:Object(i.j)({securityEnabledOnly:t})})},e.prototype.checkMemberGroups=function(t){return this.clone(e,"checkMemberGroups").postCore({body:Object(i.j)({groupIds:t})})},Object.defineProperty(e.prototype,"contactFolders",{get:function(){return new wt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drive",{get:function(){return new xt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drives",{get:function(){return new kt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tasks",{get:function(){return new ut(this,"planner/tasks")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messages",{get:function(){return new Wt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mailboxSettings",{get:function(){return new Vt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mailFolders",{get:function(){return new Qt(this)},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e.prototype.delete=function(){return this.deleteCore()},e.prototype.sendMail=function(t,n){return void 0===n&&(n=!1),this.clone(e,"sendMail").postCore({body:Object(i.j)({message:t,saveToSentItems:n})})},Object.defineProperty(e.prototype,"people",{get:function(){return new zt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"directReports",{get:function(){return new zt(this,"directReports")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"insights",{get:function(){return new Xt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"manager",{get:function(){return new e(this,"manager")},enumerable:!0,configurable:!0}),e}(M),oe=function(t){function e(e,n){void 0===e&&(e="https://graph.microsoft.com/v1.0/$batch"),void 0===n&&(n=20);var r=t.call(this)||this;return r.batchUrl=e,r.maxRequests=n,r}return r.b(e,t),e.makeUrlRelative=function(t){if(!Object(i.i)(t))return t;var e=t.indexOf(".com/v1.0/");return e<0?(e=t.indexOf(".com/beta/"))>-1?t.substr(e+10):t:t.substr(e+9)},e.formatRequests=function(t){var e=this;return t.map((function(t,n){var r={id:""+ ++n,method:t.method,url:e.makeUrlRelative(t.url)},o={};return void 0!==x.headers&&null!==x.headers&&(o=Object(i.c)(o,x.headers)),void 0!==t.options&&(void 0!==t.options.headers&&null!==t.options.headers&&(o=Object(i.c)(o,t.options.headers)),void 0!==t.options.body&&null!==t.options.body&&(r=Object(i.c)(r,{body:t.options.body}))),r=Object(i.c)(r,{headers:o})}))},e.parseResponse=function(t,e){return new Promise((function(n){for(var r=new Array(t.length).fill(null),o=0;o<e.responses.length;++o){var i=e.responses[o],s=parseInt(i.id,10)-1;204===i.status?r[s]=new Response:r[s]=new Response(JSON.stringify(i.body),i)}n({nextLink:e.nextLink,responses:r})}))},e.prototype.executeImpl=function(){var t=this;if(w.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1),this.requests.length<1)return w.write("Resolving empty batch.",1),Promise.resolve();for(var n=new G,r=this.requests.slice(),o=Promise.resolve(),s=function(){var s=r.splice(0,u.maxRequests),a={requests:e.formatRequests(s)},c={body:Object(i.j)(a),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};w.write("["+u.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),n.fetch(u.batchUrl,c).then((function(t){return t.json()})).then((function(t){return e.parseResponse(s,t)})).then((function(e){w.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),e.responses.reduce((function(e,n,r){var o=s[r];return w.write("["+t.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+o.method+" "+o.url+".",0),e.then((function(t){return o.parser.parse(n).then(o.resolve).catch(o.reject)}))}),o)}))},u=this;r.length>0;)s();return o},e}(k),ie=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.create=function(t,e,n){void 0===n&&(n={});var r=Object(i.c)({inviteRedirectUrl:e,invitedUserEmailAddress:t},n);return this.postCore({body:Object(i.j)(r)}).then((function(t){return{data:t}}))},e=r.a([B("invitations")],e)}(q),se=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new ue(this,t)},e.prototype.add=function(t,e,n,r,o){var s=this;void 0===o&&(o={});var u=Object(i.c)({changeType:t,expirationDateTime:r,notificationUrl:e,resource:n},o);return this.postCore({body:Object(i.j)(u)}).then((function(t){return{data:t,subscription:s.getById(t.id)}}))},e=r.a([B("subscriptions")],e)}(q),ue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e}(M),ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"alerts",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),e=r.a([B("security")],e)}(M),ce=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new pe(this,t)},e=r.a([B("alerts")],e)}(q),pe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e}(M),le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"root",{get:function(){return new he(this,"root")},enumerable:!0,configurable:!0}),e.prototype.getById=function(t,e){var n=t;return e&&(n=this._urlCombine(t,e)),new he(this,n)},e.prototype._urlCombine=function(t,e){return t.lastIndexOf("/")===t.length-1&&(t=t.substring(0,t.length-1)),"/"===e.charAt(0)&&(e=e.substring(1,e.length)),e.lastIndexOf("/")===e.length-1&&(e=e.substring(0,e.length-1)),t+":/"+e+":"},e=r.a([B("sites")],e)}(M),he=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"columns",{get:function(){return new ye(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentTypes",{get:function(){return new fe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drive",{get:function(){return new xt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drives",{get:function(){return new kt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lists",{get:function(){return new Te(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sites",{get:function(){return new le(this)},enumerable:!0,configurable:!0}),e}(M),fe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new de(this,t)},e=r.a([B("contenttypes")],e)}(q),de=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(M),ye=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new be(this,t)},e=r.a([B("columns")],e)}(q),be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"columnLinks",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),e}(M),ge=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new Oe(this,t)},e=r.a([B("columnlinks")],e)}(q),Oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(M),Te=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new me(this,t)},e.prototype.create=function(t,e,n){var r=this;void 0===n&&(n={});var o=Object(i.c)({displayName:t,list:e},n);return this.postCore({body:Object(i.j)(o)}).then((function(t){return{data:t,list:new me(r,t.id)}}))},e=r.a([B("lists")],e)}(q),me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"columns",{get:function(){return new ye(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentTypes",{get:function(){return new fe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drive",{get:function(){return new xt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),e}(M),_e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new Se(this,t)},e.prototype.create=function(t){var e=this,n={fields:t};return this.postCore({body:Object(i.j)(n)}).then((function(t){return{data:t,item:new Se(e,t.id)}}))},e=r.a([B("items")],e)}(q),Se=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),Object.defineProperty(e.prototype,"driveItem",{get:function(){return new Lt(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return new ve(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"versions",{get:function(){return new Ee(this)},enumerable:!0,configurable:!0}),e.prototype.delete=function(){return this.deleteCore()},e.prototype.update=function(t){return this.patchCore({body:Object(i.j)(t)})},e}(M),ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e=r.a([B("fields")],e)}(q),Ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e.prototype.getById=function(t){return new we(this,t)},e=r.a([B("versions")],e)}(q),we=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.b(e,t),e}(M),Ne=function(t){function e(e,n){return t.call(this,e,n)||this}return r.b(e,t),Object.defineProperty(e.prototype,"directoryObjects",{get:function(){return new $t(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groups",{get:function(){return new _t(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"teams",{get:function(){return new ft(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"me",{get:function(){return new re(this,"me")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"planner",{get:function(){return new ot(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"users",{get:function(){return new ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"invitations",{get:function(){return new ie(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subscriptions",{get:function(){return new se(this)},enumerable:!0,configurable:!0}),e.prototype.createBatch=function(){return new oe},e.prototype.setup=function(t){!function(t){f.extend(t)}(t)},Object.defineProperty(e.prototype,"security",{get:function(){return new ae(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sites",{get:function(){return new le(this)},enumerable:!0,configurable:!0}),e}(L),Ce=new Ne("v1.0");n.d(e,"graph",(function(){return Ce})),n.d(e,"GraphRest",(function(){return Ne})),n.d(e,"GroupType",(function(){return K})),n.d(e,"Group",(function(){return St})),n.d(e,"Groups",(function(){return _t})),n.d(e,"GraphBatch",(function(){return oe})),n.d(e,"GraphQueryable",(function(){return L})),n.d(e,"GraphQueryableCollection",(function(){return q})),n.d(e,"GraphQueryableInstance",(function(){return M})),n.d(e,"GraphQueryableSearchableCollection",(function(){return D})),n.d(e,"Teams",(function(){return ft})),n.d(e,"Team",(function(){return dt})),n.d(e,"Channels",(function(){return yt})),n.d(e,"Channel",(function(){return bt})),n.d(e,"Apps",(function(){return gt})),n.d(e,"Tabs",(function(){return Ot})),n.d(e,"Tab",(function(){return Tt})),n.d(e,"GraphEndpoints",(function(){return U})),n.d(e,"OneNote",(function(){return Ct})),n.d(e,"Notebooks",(function(){return It})),n.d(e,"Notebook",(function(){return Rt})),n.d(e,"Sections",(function(){return jt})),n.d(e,"Section",(function(){return At})),n.d(e,"Pages",(function(){return Pt})),n.d(e,"Contacts",(function(){return vt})),n.d(e,"Contact",(function(){return Et})),n.d(e,"ContactFolders",(function(){return wt})),n.d(e,"ContactFolder",(function(){return Nt})),n.d(e,"Drives",(function(){return kt})),n.d(e,"Drive",(function(){return xt})),n.d(e,"Root",(function(){return Gt})),n.d(e,"DriveItems",(function(){return Ut})),n.d(e,"DriveItem",(function(){return Lt})),n.d(e,"Children",(function(){return qt})),n.d(e,"DriveList",(function(){return Dt})),n.d(e,"Recent",(function(){return Mt})),n.d(e,"SharedWithMe",(function(){return Bt})),n.d(e,"DriveSearch",(function(){return Kt})),n.d(e,"Thumbnails",(function(){return Ft})),n.d(e,"Planner",(function(){return ot})),n.d(e,"Plans",(function(){return it})),n.d(e,"Plan",(function(){return st})),n.d(e,"Tasks",(function(){return ut})),n.d(e,"Task",(function(){return at})),n.d(e,"Buckets",(function(){return ct})),n.d(e,"Bucket",(function(){return pt})),n.d(e,"Details",(function(){return lt})),n.d(e,"DirectoryObjectType",(function(){return mt})),n.d(e,"DirectoryObjects",(function(){return $t})),n.d(e,"DirectoryObject",(function(){return Jt})),n.d(e,"Invitations",(function(){return ie})),n.d(e,"Subscriptions",(function(){return se})),n.d(e,"Subscription",(function(){return ue})),n.d(e,"Security",(function(){return ae})),n.d(e,"Alerts",(function(){return ce})),n.d(e,"Alert",(function(){return pe})),n.d(e,"People",(function(){return zt})),n.d(e,"Sites",(function(){return le})),n.d(e,"GraphSite",(function(){return he})),n.d(e,"GraphContentTypes",(function(){return fe})),n.d(e,"GraphContentType",(function(){return de})),n.d(e,"GraphColumns",(function(){return ye})),n.d(e,"GraphColumn",(function(){return be})),n.d(e,"GraphColumnLinks",(function(){return ge})),n.d(e,"GraphColumnLink",(function(){return Oe})),n.d(e,"GraphLists",(function(){return Te})),n.d(e,"GraphList",(function(){return me})),n.d(e,"GraphItems",(function(){return _e})),n.d(e,"GraphItem",(function(){return Se})),n.d(e,"GraphFields",(function(){return ve})),n.d(e,"GraphVersions",(function(){return Ee})),n.d(e,"Version",(function(){return we})),n.d(e,"Insights",(function(){return Xt})),n.d(e,"Trending",(function(){return Zt})),n.d(e,"Used",(function(){return te})),n.d(e,"Shared",(function(){return ee}))}])}));
//# sourceMappingURL=graph.es5.umd.bundle.min.js.map